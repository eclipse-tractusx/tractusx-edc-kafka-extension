#
# Copyright (c) 2025 Contributors to the Eclipse Foundation
#
# See the NOTICE file(s) distributed with this work for additional
# information regarding copyright ownership.
#
# This program and the accompanying materials are made available under the
# terms of the Apache License, Version 2.0 which is available at
# https://www.apache.org/licenses/LICENSE-2.0.
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
# License for the specific language governing permissions and limitations
# under the License.
#
# SPDX-License-Identifier: Apache-2.0
#
name: Test k8s version compatability

on:
  workflow_dispatch:
    inputs:
      k8sversion_latest:
        description: 'First version of kindest/node image for k8s kind cluster'
        default: 'v1.34.0'
        required: false
        type: string
      k8sversion_second_latest:
        description: 'Second version of kindest/node image for k8s kind cluster'
        default: 'v1.33.4'
        required: false
        type: string
      k8sversion_third_latest:
        description: 'Third version of kindest/node image for k8s kind cluster'
        default: 'v1.32.8'
        required: false
        type: string

jobs:
  test-latest:
    uses: ./.github/workflows/deployment-test.yaml
    with:
      k8sversion: ${{ github.event.inputs.k8sversion_latest || 'v1.34.0' }}

  test-second-latest:
    uses: ./.github/workflows/deployment-test.yaml
    with:
      k8sversion: ${{ github.event.inputs.k8sversion_second_latest || 'v1.33.4' }}

  test-third-latest:
    uses: ./.github/workflows/deployment-test.yaml
    with:
      k8sversion: ${{ github.event.inputs.k8sversion_third_latest || 'v1.32.8' }}